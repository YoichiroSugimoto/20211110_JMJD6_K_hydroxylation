# Introduction

This pipeline performs the analyses of LC-MS/MS data for **"Widespread hydroxylation of unstructured lysine-rich protein domains by JMJD6"**.
To run this pipeline, the LC-MS/MS data must have been processed by `Peaks Studio` or `Spectronaut` as described in the paper.
Specifically, the pipeline performs the following analyses.

0. Data preprocessing
    - Sequence and biophysical features of proteins such as local charge and disorderedness are calculated here.
1. Analysis of JMJD6 interactome data
    - Proteins co-immunoprecipitated with JMJD6 in the presence of DMOG are identified, and their characteristics are examined.
2. Analysis of JMJD6 hydroxylation sites and the stoichiometry
    - JMJD6 hydroxylation sites and the stoichiometry of the modification are analysed. In addition, the effect of JMJD6 for arginine dimethylation are also analysed.
3. Analysis of the characteristics of JMJD6 hydroxylation sites
4. Analysis of de novo sequence data


# Directory structures

## Data
Input data (outputs of LC-MS/MS data processed by `Peaks Studio` and `Spectronaut` as well as manually curated JMJD6 hydroxylation sites) are stored.

``` bash
├── data
│   ├── all_protein.fasta
│   ├── j1-JMJD6-coIP
│   │   └── 20210408-JMJD6-interactomics-data.csv
│   ├── j2-PTM-stoichiometry
│   │   ├── curated_JMJD6_substrate_sites.csv
│   │   ├── hydroxyK-methylR-stoichiometry
│   │   │   ├── HeLa_JMJD6KO_J6pep_Trypsin_oxKandMetR__protein-peptides.csv
│   │   │   ├── HeLa_JMJD6KO_JQ1_Trypsin_oxKandMetR__protein-peptides.csv
│   │   │   ├── HeLa_WT_J6pep_Trypsin_oxKandMetR__protein-peptides.csv
│   │   │   └── HeLa_WT_JQ1_Trypsin_oxKandMetR__protein-peptides.csv
│   │   ├── hydroxyK-stoichiometry
│   │   │   ├── HEK293_WT_JQ1_Trypsin_oxK__protein-peptides.csv
│   │   │   ├── HeLa_JMJD6FLAG_FLAGIP_Trypsin_oxK__protein-peptides.csv
│   │   │   ├── HeLa_JMJD6KO_J6pep_Trypsin_oxK__protein-peptides.csv
│   │   │   ├── HeLa_JMJD6KO_JQ1_Trypsin_oxK__protein-peptides.csv
│   │   │   ├── HeLa_WT_J6pep_Trypsin_oxK__protein-peptides.csv
│   │   │   ├── HeLa_WT_JQ1_Trypsin_oxK__protein-peptides.csv
│   │   │   └── MCF7_WT_JQ1_Trypsin_oxK__protein-peptides.csv
│   │   └── hydroxyK-stoichiometry_AspN
│   │       └── HeLa_WT_BRD4IP_AspN_oxK__protein-peptides.csv
│   └── j4-de-novo-data
│       ├── HeLa_JQ1_de_novo_peptides.csv
│       ├── HeLa_peptide_de_novo_peptides.csv
│       ├── J6KO_JQ1_de_novo_peptides.csv
│       └── J6KO_peptide_de_novo_peptides.csv
```

## Scripts

### Master scripts
Running `run_all_sbatch.sh` scripts will reproduce all the results and figures from this pipeline.
This script sequentially runs the `rmarkdown` scripts in `R` directory.

```bash
├── master_scripts
│   ├── run_all_sbatch.sh
│   └── sub_master_scripts
│       ├── 0_run_individual_rmds_sbatch.sh
│       ├── 1_run_individual_rmds_sbatch.sh
│       ├── 2_run_individual_rmds_sbatch.sh
│       └── 3_run_individual_rmds_sbatch.sh
```

### R(markdown) scripts

```bash
├── R
│   ├── j0-data-preprocessing
│   │   ├── j0-1-protein-feature-extraction-1.rmd
│   │   ├── j0-2-protein-feature-extraction-2.rmd
│   │   └── j0-3-merge-all-data.rmd
│   ├── j1-JMJD6-coIP-with-DMOG
│   │   └── j1-analysis-of-JMJD6-interactome-data.rmd
│   ├── j2-PTM-stoichiometry
│   │   ├── functions
│   │   │   └── stoichiometry_functions.R
│   │   ├── j2-1-hydroxy-K-stoichiometry.rmd
│   │   ├── j2-2-hydroxy-K-stoichiometry-with-AspN.rmd
│   │   └── j2-3-hydroxy-K-and-met-R-stoichiometry.rmd
│   ├── j3-properties-of-hydroxylation-sites
│   │   └── j3-properties-of-hydroxylation-sites.rmd
│   ├── j4-de-novo-data-analysis
│   │   └── j4-de-novo-data-analysis.rmd
│   └── run_rmd.R
```

## Doc
`Doc` stores the `html` and `markdown` outputs of the `rmakdown` scripts. The files contain the scripts and documentations.


## Results

`Results` stores the outputs generated by the `rmakdown` scripts.

```bash
└── results
    ├── differential-protein-abundance.csv
    ├── j0-data-preprocessing
    │   ├── all_protein_feature_per_position.csv
    ├── j2-PTM-stoichiometry
    │   ├── j2-1-PTM-stoichiometry-K-only
    │   │   ├── long_K_stoichiometry_data.csv
    │   │   └── wide_K_stoichiometry_data.csv
    │   ├── j2-2-PTM-stoichiometry-K-only-AspN
    │   │   └── hydroxylation_stoichiometry_for_AspN_data.csv
    │   └── j2-3-PTM-stoichiometry-K-and-R
    │       ├── long_K_stoichiometry_data.csv
    │       ├── long_R_stoichiometry_data.csv
    │       ├── wide_K_stoichiometry_data.csv
    │       └── wide_R_stoichiometry_data.csv
    └── j4-de-novo-data-analysis
```

